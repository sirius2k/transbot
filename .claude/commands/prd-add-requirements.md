# PRD 기능 추가 커맨드

너는 지금부터 PRD에 새로운 기능 또는 개선사항을 추가하는 제품 기획 전문가야. 사용자의 요구사항을 받아 단계별로 분석하고, PRD를 업데이트한 뒤 자동 커밋하고, 실행 계획 작성을 제안해줘.

## 실행 단계

작업은 아래 순서대로 실행해줘.

1. **사용자 입력 분석**: 아규먼트 또는 자연어로 입력된 기능 요구사항 파악
2. **단계별 질문**: 기능명, 설명, 카테고리 등 필수 정보 수집
3. **기존 PRD 확인**: 중복 기능 체크
4. **자동 분석 및 제안**: Phase, 우선순위, FEATURE/마이너 분류 판단
5. **사용자 확인**: 제안 내용을 사용자에게 확인 요청
6. **PRD 업데이트**: docs/product/PRD.md 파일 수정
7. **Git 커밋**: 변경사항 자동 커밋
8. **다음 단계 제안**: excution-plan 커맨드 실행 제안

## 1. 사용자 입력 분석

### 입력 형식

사용자는 다음 중 하나의 방식으로 요구사항을 입력할 수 있어:

```bash
/prd-add-requirements "번역 히스토리를 저장하고 조회하고 싶어"
/prd-add-requirements  # 아규먼트 없이 실행하면 대화형 모드
```

### 초기 파악사항

- 아규먼트가 있으면 해당 내용을 기반으로 기능 이해
- 아규먼트가 없으면 "어떤 기능을 추가하시겠습니까?" 질문

## 2. 단계별 질문

사용자에게 다음 정보를 순차적으로 질문해줘. **AskUserQuestion 도구를 사용**하되, 한 번에 모든 질문을 묶어서 진행해줘. 질문항목은 예상되는 답변을 미리 생각해보고 제시해주고, 사용자가 제시한 답변을 선택하거나 자율적으로 입력 할 수 있도록 해줘.

### 질문 항목

1. **기능명** (header: "기능명")
   - 추천하는 기능명도 함께 제시함.
   - 간결하고 명확하게 (예: "번역 히스토리 저장")

2. **기능 설명** (header: "기능 설명")
   - 무엇을 하는 기능인지 1-2문장으로 설명
   - 텍스트 입력

3. **카테고리** (header: "카테고리", multiSelect: true)
   - 옵션:
     - "UI/프론트엔드": 사용자 인터페이스 관련
     - "백엔드/비즈니스 로직": 데이터 처리, API 등
     - "인프라/설정": 환경 설정, 배포 관련
     - "테스트": 테스트 코드 작성
     - "문서화": 문서 업데이트
     - "통합": 외부 서비스 연동

4. **예상 소요 시간** (header: "소요 시간")
   - 옵션:
     - "30분 미만"
     - "1-2시간"
     - "2-5시간"
     - "5-10시간"
     - "10시간 이상"

## 3. 기존 PRD 확인

### 중복 체크 프로세스

1. `docs/product/PRD.md` 파일 읽기
2. 기존 기능 목록 파싱:
   - "5.2 완료된 기능" 섹션
   - "5.3 향후 개발 예정" 섹션
3. 새로운 기능명과 기존 기능 비교:
   - 키워드 매칭 (히스토리, 사전, 파일, 용어집 등)
   - 유사 기능 감지
4. 중복 발견 시:
   - 사용자에게 알림
   - "기존 FEATURE-XXX와 유사합니다. 계속 진행하시겠습니까?" 질문
   - 사용자가 "아니오"를 선택하면 종료

## 4. 자동 분석 및 제안

### 4.1 FEATURE vs 마이너 개선사항 분류

**판단 기준**:

| 분류 | 조건 |
| ---- | ---- |
| **마이너 개선사항** | 예상 소요 시간 ≤ 2시간 AND 단일 파일 수정 |
| **FEATURE** | 예상 소요 시간 > 2시간 OR 여러 파일 수정 OR 아키텍처 변경 |

### 4.2 Phase 제안

**판단 기준**:

| Phase | 조건 | 예시 |
| ----- | ---- | ---- |
| **Phase 2** | P0-P1 우선순위 + 기반 인프라 기능 | 히스토리 저장, 사전 검색 |
| **Phase 2.5** | P2-P3 우선순위 + 편의성 개선 | 즐겨찾기, 파일 업로드, 실시간 번역 |
| **Phase 3** | P3 우선순위 + 외부 연동 또는 고급 기능 | 외부 툴 연동, 용어집 |
| **향후 예정** | 아직 구체화되지 않은 아이디어 | 탐색적 기능 |

**분석 요소**:
- 우선순위 (P0-P1 → Phase 2, P2-P3 → Phase 2.5/3)
- 의존성 (다른 기능의 기반 → 빠른 Phase)
- 복잡도 (외부 연동, 아키텍처 변경 → 늦은 Phase)

### 4.3 우선순위 제안

**판단 기준**:

| 우선순위 | 조건 | 예시 |
| -------- | ---- | ---- |
| **P0** | 서비스 핵심 기능, 없으면 서비스 불가 | 양방향 번역, 자동 언어 감지 |
| **P1** | Use Case 직접 충족, 사용자 가치 높음 | 히스토리 저장, 사전 검색, 관찰성 |
| **P2** | 있으면 좋은 편의 기능, 사용자 경험 개선 | 즐겨찾기, 파일 업로드 |
| **P3** | 고급 사용자 대상, 향후 고려 | 용어집, UI 다국어 지원 |

**분석 요소**:
- Use Case 충족 여부 (PRD "3.2 사용 사례" 참조)
- 사용자 가치 (즉시 느낄 수 있는 혜택)
- 비즈니스 임팩트 (목표 지표 달성 기여도)

### 4.4 선정 이유 작성

기능의 가치를 1-2문장으로 설명:

- Use Case 충족: "Use Case 직접 충족"
- 사용자 가치: "사용자 편의성 대폭 향상"
- 기반 인프라: "다른 기능의 기반"
- 독립성: "독립적 구현 가능"
- 운영 개선: "운영 안정성 확보"

### 4.5 다음 FEATURE 번호 결정

- PRD에서 가장 큰 FEATURE 번호 찾기
- +1한 번호를 새로운 FEATURE 번호로 사용
- 예: 마지막이 FEATURE-021이면 → FEATURE-022

## 5. 사용자 확인

분석 완료 후 사용자에게 제안 내용을 출력하고 확인 요청:

```markdown
## 분석 결과

**분류**: FEATURE / 마이너 개선사항
**FEATURE 번호**: FEATURE-022 (해당 시)
**기능명**: [입력받은 기능명]
**설명**: [입력받은 설명]
**카테고리**: [선택된 카테고리]
**Phase**: [제안 Phase] (제안 이유: ...)
**우선순위**: [제안 우선순위] (제안 이유: ...)
**선정 이유**: [자동 생성된 선정 이유]

위 내용으로 PRD에 추가하시겠습니까?
- 예 (추천)
- Phase 변경
- 우선순위 변경
- 취소
```

AskUserQuestion 도구 사용하여 확인.

## 6. PRD 업데이트

### 6.1 마이너 개선사항 추가 형식

"5.3 향후 개발 예정" → "마이너 개선사항 (예정)" 테이블에 추가:

```markdown
| 🔲 [기능명] | **[우선순위]** | [소요 시간] | [설명] | - |
```

### 6.2 FEATURE 추가 형식

"5.3 향후 개발 예정" → "주요 기능 (FEATURE)" 테이블에 추가:

```markdown
| 🔲 FEATURE-XXX: [기능명] | **[우선순위]** | [선정 이유] | [Phase] |
```

### 6.3 테이블 정렬

- Phase 순서: 2 → 2.5 → 3
- 같은 Phase 내에서는 우선순위 순: P0 → P1 → P2 → P3

### 6.4 최종 수정일시 업데이트

PRD 파일 맨 아래 "최종 수정일시" 업데이트:

```markdown
**최종 수정일시**: YYYY-MM-DD HH:MM
```

## 7. Git 커밋

### 커밋 메시지 형식

```
docs(prd): [FEATURE-XXX / 마이너] [기능명] 추가

- Phase [X]: [우선순위]
- [간단한 설명]

Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>
```

### 커밋 실행

```bash
git add docs/product/PRD.md
git commit -m "..."
```

## 8. 다음 단계 제안

PRD 업데이트 및 커밋 완료 후 사용자에게 다음 단계 제안:

```markdown
## ✅ PRD 업데이트 완료

**추가된 기능**: FEATURE-XXX: [기능명]
**Phase**: [X]
**우선순위**: [PX]

### 다음 단계

FEATURE로 추가되었습니다. 실행 계획(Execution Plan)을 작성하시겠습니까?

다음 커맨드를 실행하세요:
\`\`\`bash
@.claude/commands/excution-plan.md FEATURE-XXX
\`\`\`

이 커맨드는 기능을 독립적인 Task로 분해하고 상세한 실행 계획을 생성합니다.
```

## 체크리스트

PRD 업데이트 전 확인:

- [ ] 사용자에게 필수 정보 모두 질문
- [ ] 기존 PRD에서 중복 기능 확인
- [ ] Phase 제안 (의존성, 우선순위, 복잡도 고려)
- [ ] 우선순위 제안 (Use Case, 사용자 가치, 비즈니스 임팩트 고려)
- [ ] 선정 이유 명확히 작성
- [ ] FEATURE 번호 중복 없이 할당
- [ ] 테이블 형식 및 정렬 준수
- [ ] 최종 수정일시 업데이트
- [ ] 커밋 메시지 형식 준수
- [ ] 다음 단계 (excution-plan) 제안

## 예시

### 입력

```bash
/prd-add-requirements "사용자가 번역 결과를 PDF로 내보낼 수 있게 하고 싶어"
```

### 출력

```markdown
## 기능 추가 정보 수집

다음 정보를 입력해주세요:

1. **기능명**: PDF 내보내기
2. **기능 설명**: 번역 결과를 PDF 파일로 저장하여 다운로드할 수 있는 기능
3. **카테고리**: UI/프론트엔드, 백엔드/비즈니스 로직
4. **예상 소요 시간**: 2-5시간

---

## 분석 결과

**분류**: FEATURE
**FEATURE 번호**: FEATURE-022
**기능명**: PDF 내보내기
**설명**: 번역 결과를 PDF 파일로 저장하여 다운로드
**카테고리**: UI/프론트엔드, 백엔드/비즈니스 로직
**Phase**: 2.5 (제안 이유: P2 우선순위 편의 기능, 외부 라이브러리 연동 필요)
**우선순위**: P2 (제안 이유: 사용자 편의성 개선, 필수 기능은 아님)
**선정 이유**: 번역 결과 활용도 향상. 독립적 구현 가능

위 내용으로 PRD에 추가하시겠습니까?
- 예 (추천)
- Phase 변경
- 우선순위 변경
- 취소

[사용자가 "예" 선택]

✅ PRD 업데이트 완료
✅ Git 커밋 완료

**추가된 기능**: FEATURE-022: PDF 내보내기
**Phase**: 2.5
**우선순위**: P2

### 다음 단계

FEATURE로 추가되었습니다. 실행 계획(Execution Plan)을 작성하시겠습니까?

다음 커맨드를 실행하세요:
\`\`\`bash
@.claude/commands/excution-plan.md FEATURE-022
\`\`\`
```