# TC-006: 에러 핸들링

- **작성일**: 2026-02-08
- **작성자**: QA Team
- **마지막 업데이트**: 2026-02-08
- **상태**: ✅ 완료
- **우선순위**: P1 (High)
- **예상 실행 시간**: 1분 미만

## 개요

### 테스트 목적

사용자가 잘못된 입력이나 예외 상황을 발생시켰을 때 앱이 적절한 에러 메시지를 표시하고, 사용자에게 명확한 피드백을 제공하는지 검증합니다. 빈 입력, 입력 길이 초과, 스타일 미선택 등 다양한 에러 시나리오에서 앱의 안정성을 확인합니다.

### 테스트 범위

- **에러 처리**: 예외 상황 대응 및 에러 메시지 표시
- **UI 렌더링**: 경고 및 에러 메시지 UI 표시

### 관련 FEATURE

- FEATURE-001: 영어 ↔ 한국어 양방향 번역 (입력 검증)
- FEATURE-004: 다중 스타일 번역 (스타일 선택 검증)

## 전제 조건

- [ ] Streamlit 앱이 실행 중이어야 함 (`http://localhost:8501`)
- [ ] 브라우저가 JavaScript를 지원해야 함

## 테스트 시나리오

### 시나리오 1: 입력 길이 초과 경고

**Given** (전제 조건)

- Streamlit 앱이 실행 중
- 페이지가 정상적으로 로드됨

**When** (실행 동작)

- 사용자가 최대 길이를 초과하는 매우 긴 텍스트를 입력 (50,001자)

**Then** (예상 결과)

- 입력 길이 초과 에러 메시지가 표시됨
- 에러 메시지에 현재 길이와 최대 길이 정보가 포함됨
- "⚠️ **입력 길이 제한 초과**" 텍스트가 표시됨

---

### 시나리오 2: 입력 길이 경고 (80% 이상)

**Given** (전제 조건)

- Streamlit 앱이 실행 중
- 페이지가 정상적으로 로드됨

**When** (실행 동작)

- 사용자가 최대 길이의 80% 이상인 긴 텍스트를 입력 (40,000자)

**Then** (예상 결과)

- 입력 길이 주의 경고 메시지가 표시됨
- "⚠️ **입력 길이 주의**" 텍스트가 표시됨
- 남은 용량 정보가 표시됨

---

### 시나리오 3: 스타일 미선택 경고

**Given** (전제 조건)

- Streamlit 앱이 실행 중
- 페이지가 정상적으로 로드됨
- 사이드바가 열려 있음

**When** (실행 동작)

- 모든 스타일 체크박스를 해제

**Then** (예상 결과)

- "⚠️ 최소 하나의 스타일을 선택해주세요." 경고 메시지가 표시됨
- 경고 메시지가 사이드바에 표시됨

## 테스트 데이터

### 입력 데이터

| 항목 | 값 | 설명 |
| ---- | -- | ---- |
| 긴 텍스트 (초과) | "A" * 10001 | 최대 길이 초과 (50,001자) |
| 긴 텍스트 (경고) | "B" * 8000 | 최대 길이 80% (40,000자) |

### 예상 결과

| 시나리오 | 예상 결과 | 검증 방법 |
| -------- | --------- | --------- |
| 길이 초과 | 에러 메시지 표시, "입력 길이 제한 초과" | 텍스트 포함 확인 |
| 길이 경고 | 경고 메시지 표시, "입력 길이 주의" | 텍스트 포함 확인 |
| 스타일 미선택 | 경고 메시지 표시, "최소 하나의 스타일" | 텍스트 포함 확인 |

## UI 선택자 (Playwright 참고)

| 엘리먼트 | 선택자 | 설명 |
| -------- | ------ | ---- |
| 입력 필드 | `textarea` | 메인 입력 영역 |
| 에러 메시지 영역 | 페이지 컨텐츠 | "⚠️" 또는 "입력 길이" 텍스트 검색 |
| 경고 메시지 영역 | 페이지 컨텐츠 | "경고" 또는 "주의" 텍스트 검색 |
| 사이드바 경고 | 페이지 컨텐츠 | "최소 하나의 스타일" 텍스트 검색 |

**참고**: Streamlit은 동적으로 경고 메시지를 생성하므로 페이지 컨텐츠 검색을 사용합니다.

## 실행 방법

### 수동 테스트

1. **앱 실행**

   ```bash
   streamlit run app.py
   ```

2. **시나리오 1 검증: 입력 길이 초과**
   - [ ] 50,001자 이상의 텍스트 입력
   - [ ] 에러 메시지 표시 확인
   - [ ] "입력 길이 제한 초과" 텍스트 확인

3. **시나리오 2 검증: 입력 길이 경고**
   - [ ] 40,000자의 텍스트 입력
   - [ ] 경고 메시지 표시 확인
   - [ ] "입력 길이 주의" 텍스트 확인

4. **시나리오 3 검증: 스타일 미선택**
   - [ ] 사이드바 열기
   - [ ] 모든 스타일 체크박스 해제
   - [ ] "최소 하나의 스타일을 선택해주세요." 확인

### 자동 테스트 (pytest-bdd + Playwright)

#### 실행 방법

```bash
# Streamlit 앱 실행 (별도 터미널)
streamlit run app.py

# 전체 feature 실행
pytest tests/integration/step_defs/test_error_handling.py --browser chromium --no-cov -v

# 특정 시나리오만 실행
pytest tests/integration/step_defs/test_error_handling.py -k "길이 초과" --browser chromium --no-cov -v
```

## 주의사항

- **Streamlit 특성**: 에러 메시지는 `st.error()`, 경고는 `st.warning()` 사용
- **입력 길이 검증**: Config.MAX_INPUT_LENGTH (기본 50,000자) 기준
- **동적 메시지**: 에러 메시지 내용이 입력 길이에 따라 동적으로 생성됨
- **페이지 리렌더링**: 입력이 변경될 때마다 페이지가 리렌더링되므로 대기 시간 필요
- **80% 경고**: 40,000자 이상 입력 시 경고 메시지 표시 (Config.MAX_INPUT_LENGTH * 0.8)

## 변경 이력

| 날짜 | 변경 내용 | 작성자 |
| ---- | --------- | ------ |
| 2026-02-08 | 초안 작성 | QA Team |

---

**마지막 업데이트**: 2026-02-08
