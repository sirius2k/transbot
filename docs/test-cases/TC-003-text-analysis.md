# TC-003: 텍스트 분석 및 통계

- **작성일**: 2026-02-08
- **작성자**: QA Team
- **마지막 업데이트**: 2026-02-08
- **상태**: ✅ 완료
- **우선순위**: P1 (High)
- **예상 실행 시간**: 1분 미만

## 개요

### 테스트 목적

입력 텍스트의 언어를 자동으로 감지하고, 글자 수와 토큰 수 통계가 실시간으로 정확하게 표시되는지 확인합니다. TransBot의 텍스트 분석 기능이 다양한 입력에 대해 올바르게 동작하는지 검증합니다.

### 테스트 범위

- **UI 렌더링**: 통계 정보가 화면에 올바르게 표시되는지 확인
- **데이터 처리**: 언어 감지 로직 및 통계 계산 로직의 정확성 검증

### 관련 FEATURE

- FEATURE-001: 자동 언어 감지
- FEATURE-003: 텍스트 통계 표시 (글자 수, 토큰 수)

## 전제 조건

- [ ] Streamlit 앱이 실행 중이어야 함 (`http://localhost:8501`)
- [ ] 브라우저가 JavaScript를 지원해야 함

## 테스트 시나리오

### 시나리오 1: 영어 텍스트 언어 감지

**Given** (전제 조건)

- Streamlit 앱이 실행 중
- 페이지가 정상적으로 로드됨

**When** (실행 동작)

- 사용자가 영어 텍스트를 입력: "Hello, how are you today?"

**Then** (예상 결과)

- 통계 정보가 실시간으로 표시됨
- 글자 수가 "28"로 표시됨 (공백 포함)
- 토큰 수가 표시됨

---

### 시나리오 2: 한국어 텍스트 언어 감지

**Given** (전제 조건)

- Streamlit 앱이 실행 중
- 페이지가 정상적으로 로드됨

**When** (실행 동작)

- 사용자가 한국어 텍스트를 입력: "안녕하세요, 오늘 날씨가 좋네요."

**Then** (예상 결과)

- 통계 정보가 실시간으로 표시됨
- 글자 수가 "18"로 표시됨 (공백 포함)
- 토큰 수가 표시됨

---

### 시나리오 3: 빈 텍스트 입력

**Given** (전제 조건)

- Streamlit 앱이 실행 중
- 페이지가 정상적으로 로드됨

**When** (실행 동작)

- 입력 필드를 비움

**Then** (예상 결과)

- 통계 정보가 "0자 / 0 토큰"으로 표시됨

---

### 시나리오 4: 특수 문자 포함 텍스트

**Given** (전제 조건)

- Streamlit 앱이 실행 중
- 페이지가 정상적으로 로드됨

**When** (실행 동작)

- 사용자가 특수 문자 포함 텍스트를 입력: "Hello! 123 테스트@#$"

**Then** (예상 결과)

- 통계 정보가 실시간으로 표시됨
- 글자 수가 정확하게 계산됨
- 토큰 수가 표시됨

## 테스트 데이터

### 입력 데이터

| 항목 | 값 | 설명 |
| ---- | -- | ---- |
| 영어 텍스트 | "Hello, how are you today?" | 기본 인사말 (28자) |
| 한국어 텍스트 | "안녕하세요, 오늘 날씨가 좋네요." | 기본 인사말 (18자) |
| 빈 텍스트 | "" | 빈 문자열 (0자) |
| 특수 문자 텍스트 | "Hello! 123 테스트@#$" | 영어, 숫자, 한글, 특수문자 혼합 |

### 예상 결과

| 시나리오 | 예상 통계 | 검증 방법 |
| -------- | --------- | --------- |
| 영어 텍스트 | 28자, 토큰 수 표시 | 화면에 글자 수 표시 확인 |
| 한국어 텍스트 | 18자, 토큰 수 표시 | 화면에 글자 수 표시 확인 |
| 빈 텍스트 | 0자 / 0 토큰 | "0자" 텍스트 확인 |
| 특수 문자 텍스트 | 글자 수 표시, 토큰 수 표시 | 통계 정보 존재 확인 |

## UI 선택자 (Playwright 참고)

| 엘리먼트 | 선택자 | 설명 |
| -------- | ------ | ---- |
| 입력 필드 | `textarea` | 메인 입력 영역 |
| 통계 정보 영역 | 페이지 컨텐츠 | HTML 컨텐츠에서 "자" 또는 "토큰" 검색 |
| 글자 수 표시 | 페이지 컨텐츠 | 정규식: `/\d+\s*[/,]\s*\d+,?\d*자/` |

**참고**: Streamlit은 통계를 동적으로 생성하므로 페이지 컨텐츠 검색을 사용합니다.

## 실행 방법

### 수동 테스트

1. **앱 실행**

   ```bash
   streamlit run app.py
   ```

2. **시나리오 1 검증: 영어 텍스트**
   - [ ] "Hello, how are you today?" 입력
   - [ ] 통계에 "28" 포함 확인
   - [ ] 토큰 수 표시 확인

3. **시나리오 2 검증: 한국어 텍스트**
   - [ ] "안녕하세요, 오늘 날씨가 좋네요." 입력
   - [ ] 통계에 "18" 포함 확인
   - [ ] 토큰 수 표시 확인

4. **시나리오 3 검증: 빈 텍스트**
   - [ ] 입력 필드 비우기
   - [ ] "0자" 텍스트 확인

5. **시나리오 4 검증: 특수 문자**
   - [ ] "Hello! 123 테스트@#$" 입력
   - [ ] 글자 수 표시 확인

### 자동 테스트 (pytest-bdd + Playwright)

#### 실행 방법

```bash
# Streamlit 앱 실행 (별도 터미널)
streamlit run app.py

# 전체 feature 실행
pytest tests/integration/step_defs/test_text_analysis.py --browser chromium --no-cov -v

# 특정 시나리오만 실행
pytest tests/integration/step_defs/test_text_analysis.py -k "영어" --browser chromium --no-cov -v
```

## 주의사항

- **실시간 통계**: 텍스트 입력 시 통계가 즉시 업데이트되므로 `wait_for_timeout` 사용 필요
- **글자 수 계산**: Python의 `len()` 함수 기준으로 공백 포함 모든 문자 계산
- **토큰 수**: AI 모델별로 토큰 계산 방식이 다를 수 있음
- **Streamlit 특성**: 동적으로 생성되는 HTML이므로 정확한 선택자 대신 컨텐츠 검색 사용

## 변경 이력

| 날짜 | 변경 내용 | 작성자 |
| ---- | --------- | ------ |
| 2026-02-08 | 초안 작성 | QA Team |

---

**마지막 업데이트**: 2026-02-08
