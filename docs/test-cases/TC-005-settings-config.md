# TC-005: 설정 관리

- **작성일**: 2026-02-08
- **작성자**: QA Team
- **마지막 업데이트**: 2026-02-08
- **상태**: ✅ 완료
- **우선순위**: P1 (High)
- **예상 실행 시간**: 1분 미만

## 개요

### 테스트 목적

사이드바의 다양한 설정 옵션(원문 유지, 고유명사 유지, 커스텀 스타일 등)이 올바르게 작동하고, 설정 변경이 세션 상태에 반영되는지 검증합니다. 사용자가 설정을 변경할 때 UI가 적절하게 업데이트되고, 변경된 설정이 번역 동작에 영향을 주는지 확인합니다.

### 테스트 범위

- **사용자 인터랙션**: 사이드바 옵션 선택 및 변경
- **상태 관리**: Session state 업데이트 및 유지
- **UI 렌더링**: 설정 UI 표시 및 동적 변경
- **데이터 처리**: 설정에 따른 번역 동작 변경

### 관련 FEATURE

- FEATURE-003: 원문 유지 옵션
- FEATURE-004: 다중 스타일 번역
- FEATURE-005: 고유명사 유지 옵션

## 전제 조건

- [ ] Streamlit 앱이 실행 중이어야 함 (`http://localhost:8501`)
- [ ] 브라우저가 JavaScript를 지원해야 함

## 테스트 시나리오

### 시나리오 1: 원문 유지 옵션 토글

**Given** (전제 조건)

- Streamlit 앱이 실행 중
- 페이지가 정상적으로 로드됨
- 사이드바가 열려 있음

**When** (실행 동작)

- "원문 유지" 체크박스를 선택
- "원문 유지" 체크박스를 해제

**Then** (예상 결과)

- 체크박스 상태가 선택/해제로 변경됨
- 세션 상태에 변경사항이 반영됨
- 다중 스타일 옵션이 비활성화됨 (원문 유지 선택 시)

---

### 시나리오 2: 고유명사 유지 옵션 확인

**Given** (전제 조건)

- Streamlit 앱이 실행 중
- 페이지가 정상적으로 로드됨
- 사이드바가 열려 있음

**When** (실행 동작)

- "🏷️ 고유명사 유지" 체크박스를 선택

**Then** (예상 결과)

- 체크박스가 선택 상태로 변경됨
- 세션 상태에 "preserve_proper_nouns" 설정이 반영됨

---

### 시나리오 3: 커스텀 스타일 입력

**Given** (전제 조건)

- Streamlit 앱이 실행 중
- 페이지가 정상적으로 로드됨
- 사이드바가 열려 있음

**When** (실행 동작)

- "✍️ 커스텀 스타일" 체크박스를 선택
- 커스텀 스타일 지침 입력 필드에 "유머러스한 톤으로" 입력

**Then** (예상 결과)

- 커스텀 스타일 입력 필드가 표시됨
- 입력한 텍스트가 필드에 표시됨
- 세션 상태에 커스텀 스타일 지침이 저장됨

## 테스트 데이터

### 입력 데이터

| 항목 | 값 | 설명 |
| ---- | -- | ---- |
| 커스텀 스타일 지침 | "유머러스한 톤으로" | 커스텀 스타일 입력 예시 |

### 예상 결과

| 시나리오 | 예상 결과 | 검증 방법 |
| -------- | --------- | --------- |
| 원문 유지 토글 | 체크박스 상태 변경, 다중 스타일 비활성화 | 체크박스 상태 확인 |
| 고유명사 유지 | 체크박스 선택됨, 세션 상태 업데이트 | 체크박스 상태 확인 |
| 커스텀 스타일 | 입력 필드 표시, 텍스트 저장 | 입력 필드 값 확인 |

## UI 선택자 (Playwright 참고)

| 엘리먼트 | 선택자 | 설명 |
| -------- | ------ | ---- |
| 사이드바 열기 버튼 | `[data-testid="collapsedControl"]` | 사이드바 토글 버튼 |
| 원문 유지 체크박스 | `label:has-text("원문 유지")` | 원문 유지 옵션 |
| 고유명사 유지 체크박스 | `label:has-text("고유명사 유지")` | 고유명사 유지 옵션 |
| 커스텀 스타일 체크박스 | `label:has-text("커스텀 스타일")` | 커스텀 스타일 옵션 |
| 커스텀 스타일 입력 필드 | `textarea[placeholder*="유머러스"]` | 커스텀 지침 입력 영역 |

**참고**: Streamlit은 동적으로 HTML을 생성하므로 label 기반 선택자를 사용합니다.

## 실행 방법

### 수동 테스트

1. **앱 실행**

   ```bash
   streamlit run app.py
   ```

2. **시나리오 1 검증: 원문 유지 토글**
   - [ ] 사이드바 열기
   - [ ] "원문 유지" 체크
   - [ ] 체크 상태 확인
   - [ ] "원문 유지" 해제
   - [ ] 해제 상태 확인

3. **시나리오 2 검증: 고유명사 유지**
   - [ ] 사이드바 열기
   - [ ] "🏷️ 고유명사 유지" 체크
   - [ ] 체크 상태 확인

4. **시나리오 3 검증: 커스텀 스타일**
   - [ ] "✍️ 커스텀 스타일" 체크
   - [ ] 입력 필드 표시 확인
   - [ ] "유머러스한 톤으로" 입력
   - [ ] 입력 텍스트 표시 확인

### 자동 테스트 (pytest-bdd + Playwright)

#### 실행 방법

```bash
# Streamlit 앱 실행 (별도 터미널)
streamlit run app.py

# 전체 feature 실행
pytest tests/integration/step_defs/test_settings_config.py --browser chromium --no-cov -v

# 특정 시나리오만 실행
pytest tests/integration/step_defs/test_settings_config.py -k "원문 유지" --browser chromium --no-cov -v
```

## 주의사항

- **Streamlit 특성**: 체크박스 상태 변경 시 페이지 리렌더링 발생, 충분한 대기 시간 필요
- **사이드바 상태**: 테스트 시작 시 사이드바가 닫혀있을 수 있으므로 명시적으로 열기
- **세션 상태**: 설정 변경은 세션 상태에 저장되며, 페이지 새로고침 시 초기화됨
- **원문 유지 옵션**: 활성화 시 다중 스타일 옵션이 비활성화됨 (상호 배타적)
- **커스텀 스타일**: 체크박스 선택 시에만 입력 필드가 표시되는 조건부 렌더링

## 변경 이력

| 날짜 | 변경 내용 | 작성자 |
| ---- | --------- | ------ |
| 2026-02-08 | 초안 작성 | QA Team |

---

**마지막 업데이트**: 2026-02-08
