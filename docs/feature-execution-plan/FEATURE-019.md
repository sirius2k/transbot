# FEATURE-019: UI 다국어 지원 (한국어/영어)

## 개요

- **기능명**: UI 다국어 지원 (한국어/영어)
- **상태**: 🔲 예정
- **분류**: 프론트엔드
- **우선순위**: P3 (낮음)
- **복잡도**: Standard (4-10h)
- **분석 수준**: 부분
- **진행률**: 0%
- **예상 시간**: 6시간
- **실제 소요**: - (완료 후 기록)
- **시작일**: -
- **완료일**: -

## 기능 설명

TransBot 웹 애플리케이션의 모든 UI 텍스트를 한국어와 영어로 지원합니다. 브라우저 언어 설정을 자동으로 감지하여 초기 언어를 설정하고, 사용자가 수동으로 언어를 전환할 수 있는 UI를 제공합니다. 사용자의 언어 선택은 브라우저 쿠키에 저장되어 다음 방문 시에도 유지됩니다.

### 핵심 가치

- **전역 사용자 경험**: 한국어/영어 사용자 모두 편안한 인터페이스 제공
- **자동 감지**: 브라우저 언어 설정 기반 자동 언어 선택
- **유연한 전환**: 사이드바에서 언어를 쉽게 전환 가능
- **설정 유지**: 쿠키 저장으로 다음 방문 시에도 선택한 언어 유지
- **즉시 반영**: 페이지 새로고침 없이 실시간 언어 전환

## 배경 및 필요성

현재 TransBot은 한국어로만 UI가 제공되어 영어 사용자에게는 접근성이 떨어집니다. 글로벌 사용자를 고려하여 다국어 지원이 필요하며, 특히 영어는 국제적으로 가장 널리 사용되는 언어이므로 우선적으로 지원합니다.

## 요구사항 (Functional Requirements)

### FR-1: Streamlit i18n 라이브러리 통합
- Streamlit-i18n 또는 유사 라이브러리 설치 및 설정
- 다국어 텍스트 관리 구조 구축

### FR-2: 브라우저 언어 자동 감지
- HTTP Accept-Language 헤더 기반 언어 감지
- 지원하지 않는 언어는 기본값(한국어)으로 폴백

### FR-3: 수동 언어 전환 UI
- 사이드바에 언어 선택 드롭다운 추가
- 한국어(🇰🇷 한국어), 영어(🇺🇸 English) 선택 가능

### FR-4: 쿠키 저장
- 사용자가 선택한 언어를 브라우저 쿠키에 저장
- 다음 방문 시 저장된 언어로 자동 로드
- 쿠키 만료 기간: 365일

### FR-5: 모든 UI 텍스트 다국어 처리
- 페이지 제목, 섹션 헤더
- 버튼 라벨 (복사, 지우기, 번역 등)
- 입력 필드 placeholder
- 에러 메시지
- 안내 메시지

### FR-6: 즉시 반영
- 언어 전환 시 페이지 새로고침 없이 즉시 UI 업데이트

## 작업(Task) 분해

### Task 19.1: Streamlit i18n 라이브러리 설치 및 설정

**분류**: 백엔드 (인프라)

**의존성**: 없음

**설명**: Streamlit용 i18n 라이브러리를 조사하고 설치하여 다국어 지원 기반을 마련합니다.

**세부 작업**:
1. Streamlit i18n 라이브러리 조사 (streamlit-i18n, st-i18n 등)
2. `requirements.txt`에 선택한 라이브러리 추가
3. 라이브러리 설치 및 테스트
4. 다국어 텍스트 파일 구조 설계 (JSON 또는 YAML)
5. 초기 설정 파일 생성

**예상 파일**:
- `requirements.txt`: 라이브러리 추가
- `locales/ko.json`: 한국어 텍스트
- `locales/en.json`: 영어 텍스트
- `components/i18n.py`: i18n 헬퍼 모듈 (선택적)

**예상 시간**: 1h

**테스트 범위**:
- 라이브러리 정상 로드 확인
- 기본 텍스트 로드 테스트

**완료 조건**:
- [ ] i18n 라이브러리 설치 완료
- [ ] locales 디렉토리 및 초기 파일 생성
- [ ] 라이브러리 import 및 초기화 성공

---

### Task 19.2: 브라우저 언어 감지 및 쿠키 관리 구현

**분류**: 백엔드

**의존성**: Task 19.1

**설명**: 브라우저의 언어 설정을 감지하고, 사용자 선택을 쿠키에 저장/로드하는 로직을 구현합니다.

**세부 작업**:
1. Streamlit에서 브라우저 언어 감지 방법 조사
2. 쿠키 읽기/쓰기 로직 구현 (Streamlit session_state 활용)
3. 언어 우선순위 로직 구현:
   - 1순위: 쿠키에 저장된 언어
   - 2순위: 브라우저 언어
   - 3순위: 기본 언어 (한국어)
4. 지원하지 않는 언어 코드 처리 (폴백)

**예상 파일**:
- `components/i18n.py`: 언어 감지 및 쿠키 관리 함수
- `app.py`: 초기화 로직 추가

**예상 시간**: 1.5h

**테스트 범위**:
- 브라우저 언어 감지 테스트 (ko, en, 기타)
- 쿠키 저장/로드 테스트
- 우선순위 로직 테스트

**완료 조건**:
- [ ] 브라우저 언어 자동 감지 동작
- [ ] 쿠키 저장/로드 정상 동작
- [ ] 언어 우선순위 로직 정확히 동작

---

### Task 19.3: 언어 전환 UI 추가

**분류**: 프론트엔드

**의존성**: Task 19.2

**설명**: 사이드바에 언어 선택 드롭다운을 추가하고, 선택 시 즉시 언어를 전환합니다.

**세부 작업**:
1. 사이드바에 언어 선택 selectbox 추가
2. 선택지: "🇰🇷 한국어", "🇺🇸 English"
3. 언어 선택 시 session_state 업데이트
4. 쿠키에 선택한 언어 저장
5. 즉시 UI 업데이트 (st.rerun 사용)

**예상 파일**:
- `app.py`: 사이드바 언어 선택 UI

**예상 시간**: 1h

**테스트 범위**:
- 언어 선택 UI 표시 확인
- 선택 시 즉시 언어 전환 확인
- 쿠키 업데이트 확인

**완료 조건**:
- [ ] 사이드바에 언어 선택 UI 표시
- [ ] 언어 선택 시 즉시 전환
- [ ] 선택한 언어가 쿠키에 저장

---

### Task 19.4: 모든 UI 텍스트 다국어 처리

**분류**: 프론트엔드

**의존성**: Task 19.3

**설명**: app.py의 모든 하드코딩된 한국어 텍스트를 i18n 함수 호출로 대체하고, 영어 번역을 추가합니다.

**세부 작업**:
1. `locales/ko.json`에 기존 한국어 텍스트 등록
   - 페이지 제목, 섹션 헤더
   - 버튼 라벨 (복사, 지우기, 번역)
   - placeholder 텍스트
   - 에러 메시지
   - 안내 메시지
2. `locales/en.json`에 영어 번역 추가
3. `app.py`에서 모든 텍스트를 i18n 함수로 대체
4. 동적 메시지 (포맷 문자열) 처리

**예상 파일**:
- `locales/ko.json`: 한국어 텍스트 (30-50개 키)
- `locales/en.json`: 영어 텍스트 (30-50개 키)
- `app.py`: i18n 함수 호출로 대체

**예상 시간**: 2h

**테스트 범위**:
- 한국어 UI 전체 확인
- 영어 UI 전체 확인
- 누락된 텍스트 없는지 확인

**완료 조건**:
- [ ] 모든 UI 텍스트 i18n 처리
- [ ] 한국어 번역 완료
- [ ] 영어 번역 완료
- [ ] 누락된 텍스트 없음

---

### Task 19.5: 에러 메시지 다국어 처리

**분류**: 백엔드

**의존성**: Task 19.4

**설명**: 에러 메시지와 예외 처리 메시지를 다국어로 처리합니다.

**세부 작업**:
1. `app.py`의 try-except 블록 에러 메시지 i18n 처리
2. `components/`의 에러 메시지 i18n 처리
3. 에러 메시지 JSON 키 추가

**예상 파일**:
- `app.py`: 에러 메시지 i18n 처리
- `components/translation.py`: 에러 메시지 i18n 처리
- `locales/ko.json`, `locales/en.json`: 에러 메시지 추가

**예상 시간**: 30분

**테스트 범위**:
- API 키 미입력 에러
- 네트워크 에러
- 번역 실패 에러

**완료 조건**:
- [ ] 모든 에러 메시지 다국어 처리
- [ ] 에러 발생 시 선택한 언어로 표시

---

### Task 19.6: 단위 테스트 작성

**분류**: 테스트

**의존성**: Task 19.5

**설명**: i18n 기능에 대한 단위 테스트를 작성합니다.

**세부 작업**:
1. `tests/test_i18n.py` 생성
2. 언어 감지 로직 테스트
3. 쿠키 저장/로드 테스트
4. 텍스트 로드 테스트 (키 누락 확인)
5. 폴백 로직 테스트

**예상 파일**:
- `tests/test_i18n.py`: i18n 단위 테스트

**예상 시간**: 45분

**테스트 범위**:
- 언어 감지 함수 테스트
- 텍스트 로드 함수 테스트
- 쿠키 관리 함수 테스트

**완료 조건**:
- [ ] 모든 테스트 통과
- [ ] 코드 커버리지 80% 이상
- [ ] 린팅 통과

---

### Task 19.7: 문서 업데이트

**분류**: 문서화

**의존성**: Task 19.6

**설명**: README, CLAUDE 문서에 다국어 지원 기능을 명시하고 PRD를 업데이트합니다.

**세부 작업**:
1. `README.md` 업데이트
   - UI 다국어 지원 (한국어/영어) 명시
   - 언어 전환 방법 설명
2. `CLAUDE.md` 업데이트
   - i18n 라이브러리 사용법
   - 새로운 언어 추가 방법
3. `PRD.md` 완료 표시 (🔲 → ✅)

**예상 파일**:
- `README.md`
- `CLAUDE.md`
- `PRD.md`

**예상 시간**: 15분

**테스트 범위**:
- Markdownlint 규칙 준수

**완료 조건**:
- [ ] README.md 업데이트 완료
- [ ] CLAUDE.md 업데이트 완료
- [ ] PRD.md 완료 표시
- [ ] Markdownlint 통과

---

## 작업 흐름도

```text
Task 19.1 (i18n 라이브러리 설치)
    ↓
Task 19.2 (브라우저 언어 감지 + 쿠키)
    ↓
Task 19.3 (언어 전환 UI)
    ↓
Task 19.4 (모든 UI 텍스트 i18n)
    ↓
Task 19.5 (에러 메시지 i18n)
    ↓
Task 19.6 (단위 테스트)
    ↓
Task 19.7 (문서화)
```

## 완료 기준

### 기능 완료 기준

- [ ] 한국어 UI 완전 동작
- [ ] 영어 UI 완전 동작
- [ ] 브라우저 언어 자동 감지 동작
- [ ] 사이드바에서 수동 언어 전환 가능
- [ ] 선택한 언어가 쿠키에 저장되어 다음 방문 시 유지
- [ ] 언어 전환 시 페이지 새로고침 없이 즉시 반영
- [ ] 모든 에러 메시지 다국어 표시

### 품질 기준

- [ ] 모든 단위 테스트 통과
- [ ] 코드 커버리지 80% 이상 유지
- [ ] 린팅 통과
- [ ] 누락된 번역 텍스트 없음

### 문서화 기준

- [ ] README.md 다국어 지원 명시
- [ ] CLAUDE.md i18n 사용법 설명
- [ ] PRD.md 완료 표시

## 기본 테스트 계획

### 단위 테스트

| 테스트 케이스 | 시나리오 | 예상 결과 |
|--------------|----------|-----------|
| test_detect_language_ko | Accept-Language: ko-KR | "ko" 반환 |
| test_detect_language_en | Accept-Language: en-US | "en" 반환 |
| test_detect_language_fallback | Accept-Language: fr-FR | "ko" 반환 (기본값) |
| test_load_text_ko | locale="ko", key="app.title" | 한국어 텍스트 반환 |
| test_load_text_en | locale="en", key="app.title" | 영어 텍스트 반환 |
| test_cookie_save_load | 쿠키에 "en" 저장 후 로드 | "en" 반환 |

### 통합 테스트

| 테스트 케이스 | 시나리오 | 예상 결과 |
|--------------|----------|-----------|
| 브라우저 언어 자동 감지 | 영어 브라우저로 접속 | UI가 영어로 표시 |
| 수동 언어 전환 | 사이드바에서 English 선택 | UI가 즉시 영어로 전환 |
| 쿠키 유지 | 언어 선택 후 페이지 새로고침 | 선택한 언어 유지 |
| 에러 메시지 | API 키 없이 번역 시도 | 선택한 언어로 에러 표시 |

---

**작성일**: 2026-02-02
**최종 수정일**: 2026-02-02
**작성자**: TransBot Development Team
